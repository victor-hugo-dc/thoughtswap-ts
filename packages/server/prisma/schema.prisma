generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id               String   @id @default(uuid())
  canvasId         String   @unique // Unique ID provided by Canvas
  name             String
  email            String   @unique
  role             String   @default("STUDENT") // STUDENT or TEACHER
  accessToken      String
  refreshToken     String?  // Needed for token refresh
  
  // Future relations for course and thoughts will go here
  @@map("users")
}

model Course {
  id        String   @id @default(uuid())
  joinCode  String   @unique
  title     String
  sessions  Session[]
  @@map("courses")
}

model Session {
  id        String   @id @default(uuid())
  courseId  String
  course    Course   @relation(fields: [courseId], references: [id])
  status    String   @default("ACTIVE") // ACTIVE, SWAPPING, CLOSED
  prompts   PromptUse[]
}

model PromptUse {
  id        String    @id @default(uuid())
  content   String    // The actual text of the prompt
  sessionId String
  session   Session   @relation(fields: [sessionId], references: [id])
  thoughts  Thought[]
}

model Thought {
  id          String    @id @default(uuid())
  content     String
  authorId    String    // Could be Canvas ID
  assignedTo  String?   // The Canvas ID of the student reviewing this thought
  promptUseId String
  promptUse   PromptUse @relation(fields: [promptUseId], references: [id])
}